{{ $movies := getCSV "," "data/douban/movie.csv"}}
{{$numb := .}}
{{ if . }}
    {{$numb = add . 1 }}
{{ end }}
<div class="movie-quanju">
    {{range $idx,$item := first $numb $movies}}
    {{if ne $idx 0}}
    <!--封面地址替换 -->
    {{ $imagePath := printf "images/douban/%s.jpg" (path.Base (index $item 0)) }}
    {{ $rating := index $item 8 }}
    {{ $ratingCount := 0 }} <!-- Initialize rating count to zero -->
    {{ with $rating }}
        {{ $floatRating := float $rating }} <!-- Convert rating to float -->
        {{ $ratingCount = int $floatRating }} <!-- Now safely convert the float to an integer -->
    {{ end }}
    {{ $movietype := replace (index $item 7) "," " / " }}
        <div class="movies_bankuai img-hide">
            <a rel="noreferrer" href="{{ index $item 5 }}" target="_blank">
                <img  src="{{ $imagePath | absURL }}"  loading="lazy" alt="{{ index $item 1 }}" title="{{ index $item 4 }}">
            </a>        
            <div class="movies-nrong">
                <div class="movie-title">
                    <a rel="noreferrer" href="{{ index $item 5 }}" target="_blank">{{ index $item 1 }}</a>
                </div>  
                <div class="movie-pfeng">
                    {{ if gt $ratingCount 0 }}
                        {{ range $i := seq 1 $ratingCount }}
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                                <path fill="currentColor" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24h-7.19L12 2l-2.81 7.24H2 l5.46 4.73L5.82 21z"/>
                            </svg>
                        {{ end }}
                    {{ end }}
                </div>
                <div class="movie-info">观感 : {{ index $item 9 }}</div>
                <div class="movie-time">
                    <script>
                        document.write(formatDate({{ index $item 11 }})); 
                    </script>
                </div>
            </div>
        </div>
    {{ end }}
    {{ end }}
</div>

