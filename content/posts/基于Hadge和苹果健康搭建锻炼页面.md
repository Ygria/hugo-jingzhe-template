---
title: åŸºäºHadgeå’Œè‹¹æœå¥åº·æ­å»ºé”»ç‚¼é¡µé¢
date: 2024-07-30
tags: ['å»ºç«™','ç¼–ç¨‹']
slug: "build-workout-page"
description: 'å¸Œæœ›å¯ä»¥é€šè¿‡è¿™ä¸ªé¡µé¢ï¼Œç£ä¿ƒè‡ªå·±å¥½å¥½è¿åŠ¨èµ·æ¥ï¼Œä¸å½“æ‡’æƒ°è™«'
icon: ğŸ’¦
---


# é¡µé¢æ•ˆæœ

[ç‹¬ç«‹é¡µé¢æ•ˆæœ](https://sports.ygria.site/)


![GIF 2024-7-30 10-38-48.gif](https://images.ygria.site/2024/07/3c6340d5a54764e368a4fa054aa6a56c.gif)

  
  

![image.png](https://images.ygria.site/2024/07/980543e229bdb929e8fa6b9026e9b33d.png)

  

![image.png](https://images.ygria.site/2024/07/0efa363434e427ecdac223a978046ea9.png)

  

åµŒå…¥åšå®¢æ•ˆæœï¼š [åµŒå…¥åšå®¢æ•ˆæœ: Ygria's Blog é”»ç‚¼é¡µé¢](https://ygria.site/sports/)

  

![image.png](https://images.ygria.site/2024/07/bc2f51d496a825f9ac3afb5747e5f746.png)

  
  

åŸºäºè‹¹æœå¥åº·æ•°æ®ï¼Œæ­å»ºäº†ä¸ªäººé”»ç‚¼ä¿¡æ¯é¡µé¢ï¼Œä¼šæ˜¾ç¤ºæ¯æ—¥çš„é”»ç‚¼åœ†ç¯ï¼Œå¹¶æ ¹æ®ç›®æ ‡å®Œæˆæƒ…å†µæ¸²æŸ“çƒ­åŠ›å›¾ï¼ˆ100%è¾¾æˆæ˜¾ç¤ºç»¿è‰²ï¼Œ60%åŠä»¥ä¸Šæ˜¾ç¤ºæ©™è‰²ï¼Œå¦åˆ™ä¸ºçº¢è‰²ã€‚ï¼‰

è¡¨æ ¼ä¸­æ˜¯æ¯æ¬¡é”»ç‚¼çš„è®°å½•ï¼Œä¼šè®°å½•é”»ç‚¼çš„ç±»å‹ã€è€—æ—¶ã€æ¶ˆè€—çƒ­é‡ç­‰ä¿¡æ¯ã€‚

ä¸‹é¢å°†ä»‹ç»é¡µé¢çš„æ­å»ºè¿‡ç¨‹ã€‚

  

# æ­å»ºè¿‡ç¨‹

  

## å·¥ä½œæµ

é€šè¿‡æ­å»ºå¦‚ä¸‹å·¥ä½œæµï¼Œå®ç°åœ¨æ‰‹æœºä¸Šç‚¹å‡»ä¸€ä¸‹ï¼Œå°±èƒ½åŒæ­¥æ„å»ºä¸€ä¸ªé¡µé¢ã€‚

  

![image.png](https://images.ygria.site/2024/07/09085aca8e02f4f27455e29ea11e5af2.png)

## æ•°æ®æ¥æºï¼š Hadge

  

Hadge [GitHub - ashtom/hadge: ğŸ’ª Export workout data from Health.app on iOS to a GitHub repo](https://github.com/ashtom/hadge) æ˜¯ä¸€æ¬¾å¯ä»¥å®‰è£…åœ¨è‹¹æœæ‰‹æœºä¸Šï¼Œå®ç°å¥åº·æ•°æ®å¯¼å‡ºåˆ°Githubä»“åº“çš„APPã€‚ä½ å¯ä»¥ä»TestFlightå®‰è£…å®ƒã€‚

  

![image.png](https://images.ygria.site/2024/07/cb0d0193a29e194fb3701e52239e2978.png)

  

å®‰è£…ã€æˆæƒGithubå’Œå¥åº·æ•°æ®è¯»å–ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨ä¸ºä½ åˆ›å»ºä¸€ä¸ªåå­—å«healthçš„Githubç§äººä»“åº“ï¼Œé‡Œé¢æ˜¯csvæ ¼å¼çš„å¥åº·æ•°æ®ï¼ŒåŒ…æ‹¬æ¯æ—¥æ´»åŠ¨é‡ã€æ­¥æ•°ã€é”»ç‚¼ç­‰ç­‰ã€‚

![image.png](https://images.ygria.site/2024/07/0c2a15d09045d4ca9b4b74abdb14a63e.png)

## é¡µé¢

æ–°å»ºGithubä»“åº“ä¸‹Reacté¡¹ç›®ï¼ˆæˆ‘æ˜¯åŸºäºå¼€æºé¡¹ç›® [Running Page](https://github.com/yihong0618/running_page)å¼€å‘ï¼Œæƒ³æ³•æ˜¯åç»­å¦‚æœæœ‰GPXæ•°æ®å¯ä»¥é›†æˆåœ°å›¾ï¼Œæ‰€ä»¥æ˜¯ç›´æ¥Forkçš„Running Pageã€‚ï¼‰

### CSVæ–‡ä»¶è¯»å–

å°†healthä¸­çš„æ–‡ä»¶æ‹·è´åˆ°publicç›®å½•ä¸‹ï¼Œå°±å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¿™äº›æ•°æ®äº†ã€‚

ä½¿ç”¨`papaparse`è¯»å–csvæ–‡ä»¶ï¼Œå®šä¹‰ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„hookï¼š

```typescript

import { useState, useEffect } from 'react';
import { readString } from 'react-papaparse';
const useCSVParserFromURL = (fileURL) => {
Â  const [data, setData] = useState([]);
Â  const [loading, setLoading] = useState(false);
Â  const [error, setError] = useState(null);
Â  useEffect(() => {
Â  Â  if (!fileURL) {
Â  Â  Â  setLoading(false);
Â  Â  Â  return;
Â  Â  }
Â  Â  const fetchCSV = async () => {
Â  Â  Â  setLoading(true);
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(fileURL);
Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  throw new Error('Network response was not ok');
Â  Â  Â  Â  }
Â  Â  Â  Â  const csvString = await response.text();
Â  Â  Â  Â  readString(csvString, {
Â  Â  Â  Â  Â  header: true, // optional: if your CSV string has a header row
Â  Â  Â  Â  Â  skipEmptyLines: true, // å¿½ç•¥ç©ºè¡Œ
Â  Â  Â  Â  Â  complete: (result) => {
Â  Â  Â  Â  Â  Â  setData(result.data.reverse());
Â  Â  Â  Â  Â  Â  setLoading(false);
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  error: (err) => {
Â  Â  Â  Â  Â  Â  setError(err);
Â  Â  Â  Â  Â  Â  setLoading(false);
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  });
Â  Â  Â  } catch (err) {
Â  Â  Â  Â  setError(err);
Â  Â  Â  Â  setLoading(false);
Â  Â  Â  }
Â  Â  };
Â  Â  fetchCSV();
Â  }, [fileURL]);
Â  return { data, loading, error };
};
export default useCSVParserFromURL;
```

hookä½¿ç”¨ï¼š

```typescript
const { data } = useCSVParserFromURL('/distances/2024.csv');
const { data: activityData } = useCSVParserFromURL('/activity/2024.csv');
```

å°†è¯»åˆ°çš„å†…å®¹æ ¹æ®æ—¥æœŸå½’å¹¶æˆä¸€ä¸ªæ•°ç»„ï¼Œåœ¨ç‚¹å‡»â€œå‰ä¸€å¤©â€â€œåä¸€å¤©â€æ—¶åˆ‡æ¢è¯»å–æ•°ç»„çš„ä¸‹æ ‡å³å¯ã€‚

###  å›¾è¡¨ç»˜åˆ¶

ä½¿ç”¨[d3](https://d3js.org/)å’Œ[react-calender-heatmap](https://www.npmjs.com/package/@riishabh/react-calender-heatmap)ç»˜åˆ¶å›¾è¡¨ã€‚

  d3å¯ä»¥çµæ´»åœ°ç»˜åˆ¶svgå›¾å½¢ï¼Œæˆ‘ç”¨å®ƒæ¥ç»˜åˆ¶ä¸‰å±‚åœ†ç¯ã€‚
  
  [react-calender-heatmap](https://www.npmjs.com/package/@riishabh/react-calender-heatmap)æä¾›äº†reactç»„ä»¶ï¼Œç›´æ¥æŠŠæ•°æ®ä¼ è¿›å»å°±è¡Œäº†ã€‚æˆ‘å®šä¹‰äº†é”»ç‚¼ç›®æ ‡å®Œæˆæ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œå®Œæˆ60%åŠä»¥ä¸Šæ˜¾ç¤ºä¸ºæ©™è‰²ï¼Œå¦åˆ™ä¸ºçº¢è‰²ã€‚
  ```typescript
import { useEffect, useRef, useState } from 'react';
import useCSVParserFromURL from '@/hooks/useWorkouts';
import { TileChart } from "@riishabh/react-calender-heatmap";
const Heatmap = () => {
Â  const { data: activityData } = useCSVParserFromURL('/activity/2024.csv');
Â  const [dummydata,setDummyData] = useState([]);
Â  useEffect(() => {
Â  Â  if (activityData.length === 0) return;
Â  Â  // è§£ææ•°æ®
Â  Â  const parsedData = activityData.map(row => {
Â  Â  Â  const date = row["Date"];
Â  Â  Â  const calories = +row["Move Actual"];
Â  Â  Â  const caloriesGoal = +row["Move Goal"]
Â  Â  Â  const status = calories > caloriesGoal ? 'success' : calories > caloriesGoal * 0.6 ? 'warning' : 'alert'
Â  Â  Â  return {
Â  Â  Â  Â  date: new Date(date),
Â  Â  Â  Â  status: status
Â  Â  Â  };
Â  Â  });
Â  Â  setDummyData(parsedData)
Â  }, [activityData]);
Â  return (
Â  Â  <>
Â  Â  <TileChart data={dummydata} range={6} />
Â  Â  </>
Â  );
};
export default Heatmap;
```
  ![image.png](https://images.ygria.site/2024/07/2c020fbf1054e40972ff7570f32fb946.png)
çœ‹æˆ‘çš„çƒ­åŠ›å›¾å°±çŸ¥é“æˆ‘æœ‰å¤šæ‡’äº†â€¦â€¦æˆ‘çš„ç›®æ ‡æ˜¯æ¯å¤©400åƒå¡ï¼Œæ²¡æœ‰å¾ˆé«˜ã€‚å¾—åŠªåŠ›åŠ¨èµ·æ¥æŠŠæ ¼å­éƒ½å¡«å……æˆç»¿è‰²äº†~
è¡¨æ ¼çš„æ¸²æŸ“æ²¿ç”¨äº†running pageé¡¹ç›®ä¸­çš„run tableï¼Œéå†activityä¸­çš„å†…å®¹å¹¶æ¸²æŸ“ã€‚
### æ ·å¼
èƒŒæ™¯å’Œæ–‡å­—æ ·å¼ä½¿ç”¨äº† [animata.design : # Blurry blob](https://animata.design/docs/background/blurry-**blob)å’Œ  [animata.design : # Ticker]( https://animata.design/docs/text/ticker)ã€‚
è¿™ä¸ªç½‘ç«™æä¾›äº†å¾ˆå¤šä½¿ç”¨TailwindCSSå®ç°çš„åŠ¨æ•ˆç»„ä»¶ï¼Œå¹¶æ”¯æŒç›´æ¥å¤åˆ¶ç²˜è´´åˆ°é¡¹ç›®ä¸­ï¼Œæ— éœ€å†å®‰è£…ä¾èµ–ï¼Œä¾µå…¥æ€§ä½ï¼Œä½¿ç”¨ç®€ä¾¿ã€‚ä½¿ç”¨æ—¶ä¹Ÿå¯ä»¥å­¦ä¹ å­¦ä¹ ï¼Œéå¸¸ä¸é”™~
æ‚¬åœå’Œé€‰ä¸­è¡¨æ ¼æŸåˆ—çš„æ–‡å­—æ•ˆæœæ¥è‡ªäº https://primereact.org/ é¦–é¡µï¼Œé€šè¿‡`webkit-background-clip: text;` æ–‡å­—è’™ç‰ˆ + æ¸å˜èƒŒæ™¯ + åŠ¨ç”»ï¼Œè®©æ–‡å­—æœ‰äº†å½©è‰²æ¸å˜çš„æ•ˆæœã€‚

### éƒ¨ç½²

ä½¿ç”¨CloudFlare Pages æ‰˜ç®¡éƒ¨ç½²ï¼Œç›‘å¬åˆ°pushäº‹ä»¶æ—¶è§¦å‘æ„å»ºã€‚
## Workout Page ä¸­æ‹‰å–healthå†…å®¹

ä¸Šä¸€æ­¥å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ˜¯å°†healthä»“åº“ä¸‹csvæ–‡ä»¶æ‹·è´åˆ°äº†workout pagesçš„publicç›®å½•ä¸‹ã€‚é‚£ä¹ˆæ€ä¹ˆå®ç°è‡ªåŠ¨åŒæ­¥å‘¢ï¼Ÿ
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Githubçš„Actionï¼Œåœ¨æ„å»ºæ—¶checkout healthä¸­çš„å†…å®¹ï¼Œå¹¶commitåˆ°workouts pageä¸­ã€‚
é¦–å…ˆéœ€è¦åœ¨Githubä¸­æ–°å»ºä¸€ä¸ªå…·æœ‰healthä»“åº“è®¿é—®æƒé™çš„token
å‰å¾€ [Github Setting](https://github.com/settings/tokens), æ–°å»ºtoken

![image.png](https://images.ygria.site/2024/07/558b819a1a3c547fb680c6f3c0c6515d.png)
![image.png](https://images.ygria.site/2024/07/9771a669e1f957380b45494fb4f52d65.png)


å°†è¿™ä¸ªtokené…ç½®åˆ°Actionçš„Secretä¸­ï¼š
![image.png](https://images.ygria.site/2024/07/340e68c656e95cf5c5acda21fad8a968.png)

é…ç½®Actionï¼Œå…ˆå…‹éš†å½“å‰åº“ï¼ˆworkouts pageï¼‰ï¼Œå†ç­¾å‡ºhealth ï¼ˆæŒ‡å®špathä¸º`/public`ï¼‰ï¼Œå†æäº¤ã€‚
```yaml
name: Health Data Sync
on:
  push:
    branches:
      - master
  workflow_dispatch:    
jobs:
  sync-repo:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Checkout other repository
        uses: actions/checkout@v3
        with:
          repository: Ygria/health
          path: public
          token: ${{ secrets.HEALTH_TOKEN}} # ä½¿ç”¨è‡ªå®šä¹‰çš„ token   
      - name: Commit changes
        uses: EndBug/add-and-commit@v8
        with:
          author_name: Apple Health Sync  # æäº¤è€…çš„GitHubç”¨æˆ·å
          author_email: Apple Health Sync  # æäº¤è€…çš„ç”µå­é‚®ä»¶
          message: 'Automatically commit changes'  # æäº¤ä¿¡æ¯
          add: '.'  # æ·»åŠ å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å˜æ›´
```

è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†æ¯æ¬¡æ„å»ºæ—¶ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„å¥åº·æ•°æ®äº†ã€‚
## healthæ›´æ–°è§¦å‘workout pages
é—®é¢˜æ¥äº†ï¼Œhealthå†…å®¹å˜åŒ–äº†ï¼Œè¯¥å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™æ„å»ºworkout pageså‘¢ï¼Ÿ
ç›®å‰è§¦å‘healthæ›´æ–°æ˜¯åœ¨æ‰‹æœºä¸Šå»hadge appç‚¹å‡»ï¼Œå¦‚æœä½¿ç”¨æ‰‹æœºå¿«æ·æŒ‡ä»¤è§¦å‘Github Actionï¼Œæœ‰å¯èƒ½æœ‰æ—¶åºé—®é¢˜ã€‚ï¼ˆå®šæ—¶ä»»åŠ¡å¯èƒ½ä¹Ÿæ˜¯ä¸ªå¥½ä¸»æ„ã€‚ï¼‰
æˆ‘é€‰æ‹©äº†åœ¨healthä¸­é…ç½®ä¸€ä¸ªwebhookï¼Œé€šè¿‡apiè§¦å‘workouts pageä¸­Health Data Syncçš„æ‰§è¡Œã€‚Githubæ”¯æŒé€šè¿‡RESTæ¥å£æ“ä½œGithub Actionï¼Œå¯å‚è€ƒï¼š [Github Docs: REST Actions](https://docs.github.com/en/rest/actions?apiVersion=2022-11-28)

åœ¨é…ç½®webhookæ—¶ï¼Œæˆ‘å‘ç°ä¸æ”¯æŒè‡ªå®šä¹‰è¯·æ±‚å¤´å’Œè¯·æ±‚ä½“ï¼Œæ‰€ä»¥åˆå»Cloudflareé…ç½®äº†ä¸€ä¸ªworkeråšä»£ç†ã€‚å®‰å…¨èµ·è§ï¼ŒGithubè¯·æ±‚ç«¯ä½¿ç”¨secretåŠ å¯†ï¼Œworkerä¾§åšäº†å¯†é’¥éªŒè¯ã€‚

###  Cloudflare workerä»£ç†

#### Worker ä½¿ç”¨

Workerçš„ä½¿ç”¨å¯ä»¥å‚è€ƒå®˜æ–¹æ•™ç¨‹ [Learn Cloudflare Workers - Full Course for Beginners](https://www.youtube.com/watch?v=H7Qe96fqg1M)ï¼Œæ˜¯ä¸ªå¾ˆé•¿çš„è§†é¢‘ï¼Œçœ‹å‰ååˆ†é’Ÿå°±å·®ä¸å¤šå¤Ÿç”¨äº†ã€‚

ä»¥æ›´æ˜“äºæœ¬åœ°è°ƒè¯•çš„æ–¹å¼ä½¿ç”¨Cloudflare Workerï¼š
1. åœ¨æ§åˆ¶å°ä½¿ç”¨`npx wrangler`ï¼Œ(mac oséœ€è¦åŠ ä¸Šsudo)ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨ä¼šè‡ªåŠ¨å®‰è£…wrangleræœ€æ–°ç‰ˆæœ¬
2. Â ä½¿ç”¨`wranger init`åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›® 
![image.png](https://images.ygria.site/2024/07/8b250a1e7c7ebfd70995b2a62cce44b9.png)
3. åœ¨åœ¨çº¿ç¼–è¾‘é¡µé¢ä¸Šï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»`Develop with Wrangler CLI`é¡µç­¾ï¼Œå°†é…ç½®è¿‡çš„Worker å…‹éš†åˆ°æœ¬åœ°è¿›è¡Œè°ƒè¯•ã€‚
![image.png](https://images.ygria.site/2024/07/2e57617b5007e624f2dbe5600c980056.png)

#### å‚æ•°å‡†å¤‡å’Œè„šæœ¬

1. å…ˆé€šè¿‡RESTè¯·æ±‚ï¼Œæ‹¿åˆ°éœ€è¦è§¦å‘çš„workflow id
2. åœ¨Githubä¸­æ–°å»ºä¸€ä¸ªå…·æœ‰workflowæƒé™çš„tokenï¼Œè°ƒç”¨Github apiæ—¶è¦åŠ åˆ°headerä¸­

![image.png](https://images.ygria.site/2024/07/25a369f0e661a0ac92c4e3bfd49d07c1.png)

![image.png](https://images.ygria.site/2024/07/6afd4a0168132b7f341766803227e482.png)

è„šæœ¬å†…å®¹
```javascript

addEventListener('fetch', event => {
Â  event.respondWith(handleRequest(event.request))
})

async function computeHMAC(secret, message) {
Â  const encoder = new TextEncoder()
Â  const key = await crypto.subtle.importKey(
Â  Â  'raw',
Â  Â  encoder.encode(secret),
Â  Â { name: 'HMAC', hash: 'SHA-256' },
Â  Â  false,
Â  Â  ['sign']
Â  )
Â  const signature = await crypto.subtle.sign(
Â  Â  'HMAC',
Â  Â  key,
Â  Â  encoder.encode(message)
Â  )
Â  return hex(signature)
}

function hex(buffer) {
Â  const byteArray = new Uint8Array(buffer)
Â  const hexCodes = [...byteArray].map(value => {
Â  Â  return value.toString(16).padStart(2, '0')
Â  })
Â  return hexCodes.join('')
}

function secureCompare(a, b) {
Â  if (a.length !== b.length) {
Â  Â  return false
Â  }
Â  let result = 0
Â  for (let i = 0; i < a.length; i++) {
Â  Â  result |= a.charCodeAt(i) ^ b.charCodeAt(i)
Â  }
Â  return result === 0
}

  
async function handleRequest(request) {
Â  const url = new URL(request.url)
Â  const signature = request.headers.get('x-hub-signature-256')
Â  if (!signature) {
Â Â  return new Response('Missing signature', { status: 400 })
Â  }
Â  // é¢„æœŸçš„ token
Â  const expectedToken = 'your token'
Â  const body = await request.text()
Â  const expectedSignature = `sha256=${await computeHMAC(expectedToken, body)}`
Â  if (!secureCompare(signature, expectedSignature)) {
Â  Â  return new Response('Unauthorized', { status: 401 })
Â  }


Â  const targetUrl = 'https://api.github.com/repos/name/repo/actions/workflows/your flow id/dispatches'
Â  // åˆ›å»ºæ–°çš„è¯·æ±‚å¤´
Â  const newHeaders = new Headers({})
Â  newHeaders.set('Content-Type', 'application/json')
Â  newHeaders.set('Authorization', 'your token')
Â  newHeaders.set('Accept', 'application/vnd.github.v3+json')
Â  newHeaders.set('User-Agent', 'application/vnd.github.v3+json')
Â  // åˆ›å»ºæ–°çš„è¯·æ±‚ä½“
Â  const newBody = JSON.stringify({
Â  Â  "ref":"master"
Â  })
Â  // è½¬å‘è¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨
Â  const response = await fetch(targetUrl, {
Â  Â  method: 'POST',
Â  Â  headers: newHeaders,
Â  Â  body: newBody
Â  })

Â  // è¿”å›ç›®æ ‡æœåŠ¡å™¨çš„å“åº”
Â  const responseBody = await response.text()
Â  return new Response(responseBody, {
Â  Â  status: response.status,
Â  Â  headers: response.headers
Â  })
}
```

éƒ¨ç½²workeråï¼Œå°†workerçš„è®¿é—®urlé…ç½®åˆ°healthçš„webhookä¸­å³å¯ã€‚

![image.png](https://images.ygria.site/2024/07/1adf02784f781aa46c924830141a4e5c.png)


## åµŒå…¥åšå®¢

### åµŒå…¥æ—¶æ ·å¼
æƒ³åœ¨æˆ‘çš„Hugoé™æ€åšå®¢ä¸­ä¹Ÿèƒ½çœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨iframeåµŒå…¥ã€‚åµŒå…¥çš„é¡µé¢æ ·å¼ç•¥æœ‰ä¸åŒï¼Œå¯ä»¥åœ¨workout pagesä¸­ï¼Œå¢åŠ ä¸€ä¸ªhookæ¥åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯åµŒå…¥çš„é¡µé¢ï¼š

```typescript
import { useEffect, useState } from 'react';
const useIsEmbedded = () => {
Â  const [isEmbedded, setIsEmbedded] = useState(false);
Â  useEffect(() => {
Â  Â  // æ£€æµ‹å½“å‰é¡µé¢æ˜¯å¦è¢«åµŒå…¥åˆ° iframe ä¸­
Â  Â  if (window.self !== window.top) {
Â  Â  Â  setIsEmbedded(true);
Â  Â  }
Â  }, []);
Â  return isEmbedded;
};
export default useIsEmbedded;
```
ä½¿ç”¨ï¼šæ§åˆ¶åµŒå…¥æ—¶ä¸æ˜¾ç¤ºheader
```tsx
import useIsEmbedded from '@/hooks/useIsEmbedded';

const isEmbedded = useIsEmbedded();

{!isEmbedded && (<>
	<Header /></>)}
```
é€šè¿‡ä¸€äº›æ ·å¼è°ƒæ•´ï¼Œå¯ä»¥è®©é¡µé¢åµŒå…¥æ˜¾å¾—æ›´èåˆã€‚

### hugoä¸­iframe

```go
{{ define "body_classes" }}page-workouts{{ end }} {{ define "main" }
{{ $src := .Params.src }}
{{ $width := .Params.width | default "100%" }}
{{ $tryautoheight := .Params.tryautoheight | default true }}
{{ $style := .Params.style | default "min-height:98vh; border:none;" }}
{{ $sandbox := .Params.sandbox | default false }}
{{ $name := .Params.name | default "iframe-name" }}
{{ $id := .Params.id | default "iframe-id" }}
{{ $class := .Params.class }}
{{ $sub := .Params.sub | default "Your browser can not display embedded frames. You can access the embedded page via the following link:" }}
{{ with $src }}
{{ if $tryautoheight }}
Â  <script type="text/javascript">
Â  Â  function resizeIframe(iframe) {
Â  Â  Â  iframe.height = iframe.contentWindow.document.body.scrollHeight + "px";
Â  Â  }
Â  </script> Â 
{{ end }}
<div className="container">
Â  Â  <div className="blob-container">
Â  Â  Â  <div
Â  Â  Â  Â  class ="blob blob-blue" ></div>
Â  Â  Â  <div
Â  Â  Â  Â class =
Â  Â  Â  Â  Â  "blob blob-purple"
Â  Â  Â  ></div>
Â  Â  </div>
Â  </div>
<iframe id="{{ $id }}"{{ with $class }} class="{{ $class }}"{{ end }} src="{{ $src }}" width="{{ $width }}" name="{{ $name }}"{{ with $style }} style="{{ $style | safeCSS }}"{{ end }}{{ if $tryautoheight }} onload="resizeIframe(this)"{{ end }} referrerpolicy="no-referrer"{{ if (eq $sandbox false)}}{{ else if (eq $sandbox true) }} sandbox{{ else }} sandbox="{{ $sandbox }}"{{ end }}>
Â  <p>{{ $sub }} <a href="{{ $src }}">{{ $src }}</a></p>
</iframe>
{{ end }}

{{end}}
```
åœ¨é”»ç‚¼ markdownæ–‡ä»¶çš„front matterä¸­ï¼Œå£°æ˜éœ€è¦åµŒå…¥çš„é¡µé¢urlå³å¯ã€‚
![image.png](https://images.ygria.site/2024/07/4015baa8338327ff1db9395109de866e.png)

# å°ç»“
é”»ç‚¼é¡µé¢å®Œå·¥~å¸Œæœ›å¯ä»¥é€šè¿‡è¿™ä¸ªé¡µé¢ï¼Œç£ä¿ƒè‡ªå·±å¥½å¥½è¿åŠ¨èµ·æ¥ï¼Œä¸å½“æ‡’æƒ°è™«ã€‚